<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction Results</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/interactjs@1.10.11/dist/interact.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            interact('canvas').draggable({
                onmove: function (event) {
                    var target = event.target,
                        x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
                        y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    target.style.transform = 'translate(' + x + 'px, ' + y + 'px)';
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                }
            }).resizable({
                edges: { left: true, right: true, bottom: true, top: true },
                listeners: {
                    move(event) {
                        var target = event.target,
                            x = (parseFloat(target.getAttribute('data-x')) or 0),
                            y = (parseFloat(target.getAttribute('data-y')) or 0),
                            width = event.rect.width,
                            height = event.rect.height;
                        target.style.width = width + 'px';
                        target.style.height = height + 'px';
                        target.style.transform = 'translate(' + x + 'px, ' + y + 'px)';
                    }
                }
            });
            interact('.text-input').draggable({
                onmove: function (event) {
                    var target = event.target,
                        x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
                        y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    target.style.transform = 'translate(' + x + 'px, ' + y + 'px)';
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                }
            }).on('input', function (event) {
                var canvas = document.querySelector('#' + event.target.dataset.canvas);
                var ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillText(event.target.value, 10, 50);
            });
        });
    </script>
</head>
<body class="bg-gray-100">
    <h1 class="text-xl font-bold">Extraction Results</h1>
    <h2 class="text-lg">Extracted Text:</h2>
    <p>{{ text }}</p>
    <h2 class="text-lg">Extracted Images:</h2>
    {% for image in images %}
    <div class="flex flex-col items-center mb-4 relative">
        <canvas id="canvas{{ loop.index }}" width="500" height="300" class="z-10"></canvas>
        <img id="image{{ loop.index }}" src="{{ image }}" alt="Extracted Image" class="absolute top-0 left-0 w-full h-full z-0">
        <input type="text" id="text{{ loop.index }}" class="mt-2 text-input" data-canvas="canvas{{ loop.index }}" style="position: absolute; top: 0; left 0; width: 100%; height: 100%; z-index: 20; background: rgba(255, 255, 255, 0.5); font-size: 16px;">
    </div>
    {% endfor %}
    <br>
    <a href="/" class="underline">Go back</a>
</body>
</html>
